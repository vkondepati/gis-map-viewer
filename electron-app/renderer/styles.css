/* Layer Dialogs */
#dialog-create-layer .dialog-content label,
#dialog-rename-layer .dialog-content label {
  color: #fff;
  font-size: 13px;
  margin-top: 8px;
  display: block;
}
#draworder-list li {
  background: #08314f;
  color: #fff;
  padding: 8px;
  margin-bottom: 6px;
  border-radius: 3px;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: grab;
}
#draworder-list .drag-handle {
  cursor: grab;
  font-size: 18px;
  margin-right: 8px;
}
html,body,#app,#map{height:100%;}
body{margin:0;font-family:Segoe UI,Roboto,Arial,sans-serif}
#app{display:flex;flex-direction:column;height:100vh}
#app-content{display:flex;flex:1;overflow:hidden}

/* Toolbar */
#toolbar{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#0a1f2e;border-bottom:1px solid #072034;color:#fff;box-sizing:border-box}
#toolbar-left{display:flex;align-items:center;gap:16px}
#toolbar-buttons{display:flex;gap:8px}
.toolbar-btn{background:none;border:1px solid #366b94;color:#fff;padding:6px 10px;border-radius:4px;cursor:pointer;font-size:16px;transition:all 0.2s}
.toolbar-btn:hover{background:#366b94;box-shadow:0 0 6px rgba(54,107,148,0.5)}

/* Dropdown menu */
.dropdown-menu{position:absolute;top:100%;left:0;background:#0d2740;border:1px solid #366b94;border-radius:4px;min-width:180px;z-index:1002;box-shadow:0 4px 12px rgba(0,0,0,0.3)}
.dropdown-item{display:block;width:100%;text-align:left;background:none;border:none;color:#fff;padding:10px 12px;cursor:pointer;font-size:14px;transition:background 0.2s;border-bottom:1px solid #072034}
.dropdown-item:last-child{border-bottom:none}
.dropdown-item:hover{background:#366b94}
.dropdown-item:active{background:#4a8ec0}
/* Dropdown group styling */
.dropdown-group{padding:6px 4px}
.dropdown-group-title{font-size:12px;color:#99c2dd;padding:6px 8px}
.dropdown-sep{height:1px;background:#072034;margin:6px 0}

#sidebar{width:300px;background:#0d2740;color:#fff;padding:12px;box-sizing:border-box;overflow-y:auto}
#sidebar h2{margin:0 0 12px}
.controls{display:flex;flex-direction:column;gap:8px}
#layers{margin-top:16px;background:#072034;padding:8px;border-radius:4px}
#map-container{flex:1}
#map{height:100%}
#layer-list{list-style:none;padding:0;margin:0}
#layer-list li{background:#0f3b5a;padding:6px;margin-bottom:6px;border-radius:3px}

#attribute-table{width:100%;height:100%;overflow:auto;background:#fff;color:#000}
#attr-table{width:100%;border-collapse:collapse;font-size:11px}
#attr-table th,#attr-table td{border:1px solid #ddd;padding:4px;font-size:11px}
#attr-table th{background:#f0f0f0;position:sticky;top:0;font-weight:bold}
#attr-table td[contenteditable]{background:#fffbe6}
#attr-table tr.attr-row-selected td{background:#d8f6ff}
#attr-table tr.attr-row-selected td.attr-row-selector{background:#00d1ff;color:#00222b;font-weight:700}
#attr-table td.attr-row-selector{white-space:nowrap;cursor:pointer;min-width:44px}
#attr-table td.attr-row-selector .row-select-glyph{margin-right:6px;display:inline-block;width:12px;text-align:center}
#attr-table td.attr-row-selector .row-dirty-indicator{color:#cc6b00;font-weight:700}

/* Connections area */
#connection-controls{display:flex;flex-direction:column;gap:6px;margin-top:6px}

/* Collapsible sections */
.section{margin-top:12px;background:#0d2740;border-radius:4px;overflow:hidden;max-height:1000px;transition:max-height 0.4s ease-in-out}
.section.collapsed{max-height:0;overflow:hidden}
.section-header{display:flex;justify-content:space-between;align-items:center;padding:8px;background:#0a1f2e;cursor:pointer}
.section-header h3{margin:0;color:#fff;font-size:14px}
.toggle-btn{background:none;border:none;color:#fff;font-size:16px;cursor:pointer;padding:0 4px;min-width:24px}
.section-content{padding:8px;overflow:hidden}

/* Bottom panel */
#map-container{position:relative;display:flex;flex-direction:column;flex:1}
#map{flex:1;z-index:1}
.bottom-panel{position:absolute;bottom:0;left:0;right:0;background:#0d2740;border-top:2px solid #0a1f2e;z-index:10;max-height:300px;transition:max-height 0.4s ease-in-out;display:flex;flex-direction:column}
.bottom-panel.collapsed{max-height:45px}
.panel-header{display:flex;justify-content:space-between;align-items:center;padding:8px;background:#0a1f2e;color:#fff;border-bottom:1px solid #072034;flex-shrink:0}
.panel-header h3{margin:0;font-size:14px;color:#fff}
.panel-content{flex:1;overflow:auto;padding:8px}

/* TOC / layers */
.toc-list{list-style:none;padding:0;margin:0}
.toc-list li{display:flex;align-items:center;gap:8px;background:#08314f;padding:6px;margin-bottom:6px;border-radius:3px;color:#fff}
.toc-list li.active-layer{outline:2px solid #5fd1ff;background:#0c466b}
.toc-list li .layer-name{flex:1}
.toc-list li.dirty-layer .layer-name::after{content:" *";color:#ffd166;font-weight:700}
.toc-list input[type="checkbox"]{transform:scale(1.1)}
.selection-status{margin-top:8px;font-size:12px;color:#99c2dd;text-align:left}

.file-ops-panel{margin-top:14px;padding:8px;border:1px solid #366b94;border-radius:4px;background:#072034}
.file-ops-header{font-size:13px;font-weight:700;color:#cfe8ff;margin-bottom:8px}
.file-ops-row{display:flex;gap:6px;margin-bottom:6px}
.file-ops-panel button,.file-ops-panel select,.file-ops-panel input{font-size:12px}
.file-ops-panel button{background:#366b94;color:#fff;border:none;padding:6px 8px;border-radius:4px;cursor:pointer}
.file-ops-panel button:hover{background:#4a8ec0}
.file-ops-panel select,.file-ops-panel input{width:100%;padding:6px;border:1px solid #366b94;background:#0d2740;color:#fff;border-radius:4px;box-sizing:border-box}
.file-ops-list{max-height:170px;overflow:auto;border:1px solid #274a66;border-radius:4px;background:#0d2740}
.file-ops-item{display:flex;align-items:center;gap:6px;padding:6px 8px;border-bottom:1px solid #19364d;font-size:12px;cursor:pointer}
.file-ops-item:last-child{border-bottom:none}
.file-ops-item:hover{background:#133a58}
.file-ops-item.selected{background:#1e5f89}
.file-ops-kind{opacity:0.8;font-size:11px}

/* Symbol swatch */
.sym-swatch{width:20px;height:20px;border-radius:4px;border:1px solid #ccc;display:inline-block;cursor:pointer}
.sym-popup{position:fixed;z-index:1200;min-width:320px;max-width:360px;background:#022939;border:1px solid #366b94;border-radius:6px;padding:10px;box-shadow:0 8px 24px rgba(0,0,0,0.4)}
.sym-editor{background:#022939;padding:8px;border-radius:4px;margin-top:6px}
.sym-editor label{color:#fff;font-size:12px;display:block;margin-bottom:6px}
.sym-editor input[type="number"],.sym-editor input[type="color"],.sym-editor input[type="range"],.sym-editor select{width:100%}

/* Connection Dialogs */
.modal-overlay{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.7);
  z-index:1000;
  display:none;
}
.modal-overlay.visible{
  display:block !important;
  z-index:1000 !important;
}
.connection-dialog{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:white;
  padding:20px;
  border:none;
  border-radius:8px;
  box-shadow:0 4px 20px rgba(0,0,0,0.4);
  z-index:1001;
  display:none;
  min-width:300px;
}
.connection-dialog.visible{
  display:block !important;
  z-index:1001 !important;
}
.connection-dialog.modal-hidden{
  display:none !important;
}
.dialog-content{background:#0d2740;color:#fff;padding:20px;min-width:350px;border-radius:6px}
.dialog-content h3{margin:0 0 12px;font-size:16px}
.dialog-content input,.dialog-content select{width:100%;padding:8px;margin:8px 0;border:1px solid #366b94;background:#072034;color:#fff;border-radius:4px;box-sizing:border-box}
.dialog-content textarea{width:100%;padding:8px;margin:8px 0;border:1px solid #366b94;background:#072034;color:#fff;border-radius:4px;box-sizing:border-box;resize:vertical}
.dialog-content input::placeholder{color:#999}
.dialog-content button{background:#366b94;color:#fff;border:none;padding:8px 16px;margin-top:8px;margin-right:8px;border-radius:4px;cursor:pointer;transition:background 0.2s}
.dialog-content button:hover{background:#4a8ec0}

/* Compact add-feature attributes dialog */
#dialog-add-feature-attrs{
  top:72px;
  right:16px;
  left:auto;
  transform:none;
  width:min(400px, calc(100vw - 32px));
  padding:10px;
}
#dialog-add-feature-attrs .dialog-content{
  min-width:0;
  width:100%;
  max-height:76vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
#add-feature-attrs-container{
  max-height:42vh;
  overflow-y:auto;
  padding-right:6px;
}
@media (max-width: 700px){
  #dialog-add-feature-attrs{
    top:50%;
    left:50%;
    right:auto;
    transform:translate(-50%,-50%);
  }
}
/* Context Menu */
.context-menu{position:fixed;background:#0d2740;border:1px solid #366b94;border-radius:4px;z-index:2000;box-shadow:0 2px 8px rgba(0,0,0,0.3);min-width:180px}
.context-menu.show{display:block !important}
.context-menu button{display:block;width:100%;text-align:left;padding:10px 15px;background:none;border:none;color:#fff;cursor:pointer;font-size:14px;transition:background 0.2s}
.context-menu button:hover{background:#366b94}
.context-menu button:disabled{opacity:0.45;cursor:not-allowed}
.context-menu button:first-child{border-radius:4px 4px 0 0}
.context-menu button:last-child{border-radius:0 0 4px 4px}
.label-marker{background:transparent;border:none}

/* PDF print layout */
#pdf-print-layout{position:fixed;inset:0;background:#eef3f7;z-index:3500;padding:14px;box-sizing:border-box;overflow:auto}
.print-sheet{min-height:95vh;display:flex;flex-direction:column;background:#fff;border:1px solid #d4dde6}
.print-header{padding:10px 12px;border-bottom:1px solid #dce5ee;font-size:16px;font-weight:700;color:#0a1f2e}
.print-body{flex:1;display:flex;min-height:0}
.print-map-wrap{flex:1;position:relative;padding:10px}
#pdf-print-map{height:100%;width:100%;border:1px solid #ccd8e5}
.print-side{width:280px;border-left:1px solid #dce5ee;padding:10px;overflow-y:auto;background:#f7fafc}
.print-north{position:absolute;top:20px;right:20px;background:#fff;border:1px solid #bac7d3;padding:6px 8px;font-weight:700;font-size:12px}
.print-legend-item{display:flex;align-items:center;gap:8px;margin-bottom:6px;font-size:12px;color:#1e3347}
.print-legend-swatch{width:16px;height:16px;border:1px solid #6a8198}
.print-attrs-pages{margin-top:12px;background:#fff;border:1px solid #d4dde6;padding:12px}
.print-page-break{break-before:page;page-break-before:always}
.print-attr-table{width:100%;border-collapse:collapse;font-size:11px;margin-top:8px}
.print-attr-table th,.print-attr-table td{border:1px solid #d4dde6;padding:4px;text-align:left;vertical-align:top;word-break:break-word}
.print-attr-table th{background:#ecf2f8}

@media print{
  #pdf-print-layout{position:static !important;inset:auto !important;padding:0 !important;background:#fff !important;overflow:visible !important}
  .print-sheet{min-height:auto !important;border:none !important}
  .print-attrs-pages{border:none !important;padding:0 !important}
}
